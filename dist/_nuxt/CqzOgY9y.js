import he from"./gsAQBcon.js";import{_ as xe}from"./Cn02XgkK.js";import{i as K,_ as be}from"./CWelvRdo.js";import{r as i,k as Q,x as I,y as h,z as n,K as $,R as V,X as r,V as le,A as J,L as ee,O as ke,Y as te,N as we,P as _e,Q as Ce,S as oe,I as j,o as Se,B as q,J as N,W as Te}from"./DKi7S-AL.js";import{_ as ne}from"./DlAUqK2U.js";const Ae={class:"bg-white rounded-2xl shadow-lg w-full max-w-2xl p-6 animate-fadeIn"},Ie={class:"flex justify-between items-center border-b pb-3 mb-4"},$e={class:"flex space-x-2 mb-4"},De={key:0},ze={key:0,class:"mt-6"},Re={class:"w-full bg-gray-200 rounded-full h-3"},Be={class:"text-sm text-gray-700 text-center mt-2"},Ee={key:1},Me={class:"flex justify-between items-center mb-4"},Ve={class:"grid grid-cols-2 sm:grid-cols-3 gap-3 max-h-64 overflow-y-auto"},Ue=["onClick"],Le=["src","alt"],Fe={class:"text-xs text-center text-gray-500 truncate"},je={class:"mt-6 text-center"},qe={__name:"ImageUploadModal",props:{side:{type:String,default:"front"}},emits:["uploaded","close"],setup(Z,{emit:D}){const w=Z,p=D,_=i(null),y=i(0),g=i("upload"),z=i([{src:"https://placekitten.com/200/300",name:"Kitten 1",category:"nature"},{src:"https://placekitten.com/300/300",name:"Kitten 2",category:"people"},{src:"https://placekitten.com/400/300",name:"Kitten 3",category:"tech"}]),b=i(""),C=i(""),W=Q(()=>z.value.filter(v=>{const s=C.value?v.category===C.value:!0,u=v.name.toLowerCase().includes(b.value.toLowerCase());return s&&u}));function R(){_.value?.click()}function B(v){const s=Array.from(v.target.files);if(!s.length)return;let u=0;y.value=0;const U=(k,X)=>{const E=new FileReader;E.onload=()=>{const Y={src:E.result,name:k.name,category:"uncategorized"};z.value.push(Y),p("uploaded",{side:w.side,src:E.result,name:k.name,category:"uncategorized"}),u++,y.value=Math.round(u/s.length*100),u===s.length&&setTimeout(()=>y.value=0,600)},E.readAsDataURL(k)};s.forEach((k,X)=>U(k))}function O(v){p("uploaded",{side:w.side,src:v.src,name:v.name,category:v.category}),p("close")}return(v,s)=>(h(),I("div",{role:"dialog","aria-modal":"true","aria-label":"Image Manager",class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:s[6]||(s[6]=oe(u=>v.$emit("close"),["self"]))},[n("div",Ae,[n("div",Ie,[s[7]||(s[7]=n("h3",{class:"text-xl font-semibold text-gray-800"},"Image Manager",-1)),n("button",{class:"text-gray-400 hover:text-red-500 transition",onClick:s[0]||(s[0]=u=>v.$emit("close"))}," âœ• ")]),n("div",$e,[n("button",{class:V(["px-4 py-2 rounded",r(g)==="upload"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"]),onClick:s[1]||(s[1]=u=>g.value="upload")}," Upload Image ",2),n("button",{class:V(["px-4 py-2 rounded",r(g)==="library"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"]),onClick:s[2]||(s[2]=u=>g.value="library")}," Uploaded Images ",2)]),r(g)==="upload"?(h(),I("div",De,[n("div",{class:"flex flex-col items-center justify-center p-6 border-2 border-dashed border-blue-400 rounded-lg cursor-pointer hover:bg-blue-50 transition",onClick:R},[s[8]||(s[8]=n("svg",{class:"w-12 h-12 text-blue-500 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 15a4 4 0 014-4h1V7a4 4 0 014-4h2a4 4 0 014 4v4h1a4 4 0 014 4v5H3v-5z"})],-1)),s[9]||(s[9]=n("p",{class:"text-sm text-gray-600"},"Click to select an image",-1)),n("input",{ref_key:"fileInput",ref:_,type:"file",accept:"image/*",multiple:"",class:"hidden",onChange:B},null,544)]),r(y)>0?(h(),I("div",ze,[n("div",Re,[n("div",{class:"bg-blue-500 h-3 rounded-full transition-all duration-300 ease-in-out",style:le({width:r(y)+"%"})},null,4)]),n("p",Be," Uploading... "+J(r(y))+"% ",1)])):$("",!0)])):$("",!0),r(g)==="library"?(h(),I("div",Ee,[n("div",Me,[ee(n("input",{"onUpdate:modelValue":s[3]||(s[3]=u=>te(b)?b.value=u:null),type:"text",placeholder:"Search image...",class:"w-full px-3 py-2 border rounded"},null,512),[[ke,r(b)]]),ee(n("select",{"onUpdate:modelValue":s[4]||(s[4]=u=>te(C)?C.value=u:null),class:"ml-2 px-3 py-2 border rounded"},s[10]||(s[10]=[n("option",{value:""},"All",-1),n("option",{value:"nature"},"Nature",-1),n("option",{value:"tech"},"Tech",-1),n("option",{value:"people"},"People",-1)]),512),[[we,r(C)]])]),n("div",Ve,[(h(!0),I(_e,null,Ce(r(W),(u,U)=>(h(),I("div",{key:U,class:"cursor-pointer border rounded hover:border-blue-500",onClick:k=>O(u)},[n("img",{src:u.src,alt:u.name,class:"w-full h-24 object-cover rounded"},null,8,Le),n("p",Fe,J(u.name),1)],8,Ue))),128))])])):$("",!0),n("div",je,[n("button",{class:"px-4 py-2 text-sm bg-red-500 text-white rounded hover:bg-red-600 transition",onClick:s[5]||(s[5]=u=>v.$emit("close"))}," Cancel ")])])]))}},Ne=ne(qe,[["__scopeId","data-v-9f69a475"]]),We={class:"flex h-screen bg-gray-100 overflow-hidden"},Oe={class:"flex-1 flex flex-col items-center p-4"},Xe={class:"flex flex-col items-center w-full mb-4"},Ye={class:"mb-4 max-w-xs w-full"},Ge={class:"flex border border-gray-300 rounded-md overflow-hidden"},He=["disabled"],Ke=["disabled"],Qe={class:"flex justify-end space-x-2 w-full"},Je={class:"px-2 py-1 bg-gray-200 rounded text-sm"},Ze={class:"flex-1 w-full flex justify-center items-start overflow-auto"},Pe={class:"card w-full h-full"},et={class:"front border border-gray-300 w-full h-full absolute top-0 left-0"},tt={class:"back border border-gray-300 w-full h-full absolute top-0 left-0"},lt={__name:"page-builder",props:{selectedElementId:{type:[String,Number],default:null}},setup(Z){const D=i([]),w=i([]),p=i("front");i("design");const _=i(100),y=i(!1),g=i(!1),z=i(null);i(null);const b=i({}),C=i(null),W=i(null),R=i(!1),B=i(!1),O=Q(()=>_.value/100),v=t=>{g.value||p.value===t||(g.value=!0,p.value=t,setTimeout(()=>{g.value=!1},600))},s=t=>{_.value=Math.max(50,Math.min(200,_.value+t))},u=()=>{y.value=!y.value},U=t=>{};function k(t){t.preventDefault();const e=z.value.getBoundingClientRect(),o=t.clientX,a=t.clientY;C.value=o-e.left,W.value=a-e.top}const X=({item:t,x:e,y:o})=>{const a=z.value.getBoundingClientRect(),f=e-a.left,L=o-a.top;b.value={item:t,side:p.value,position:{top:L,left:f},properties:{y:L,x:f}}};function E(t){D.value.push({id:Date.now(),text:t,type:"img",label:"IMG Label",position:{top:100,left:100},size:{width:250,height:150},rotation:0,isSelected:!1,isDragging:!1,direction:"ltr"}),R.value=!1}function Y(t){w.value.push({id:Date.now(),text:t,type:"img",label:"IMG Label",position:{top:100,left:100},size:{width:250,height:150},rotation:0,isSelected:!1,isDragging:!1,direction:"ltr"}),B.value=!1}const G=i(null);i({width:210,height:297});const d=i([]),c=i(null),H=i(null),S=i([]),T=i("both sides"),l=i({});j(()=>[p.value,D.value,w.value],([t,e,o])=>{const a=t==="front"?e:o;if(!a||!Array.isArray(a)){console.warn("Invalid canvas data:",a),d.value=[];return}d.value=[...a]},{deep:!0});const P=t=>{console.log("Received selected element:",t),c.value=t},M=Q(()=>{if(c.value===null)return null;const t=d.value.find(e=>e.id===c.value);return console.log("Selected Element Type:",t.type),t?t.type:null}),re=t=>{const e=document.querySelector(`[data-element-id="${t.id}"]`);e&&K(e).draggable({enabled:!t.properties.lock,inertia:!0,modifiers:[K.modifiers.restrictRect({restriction:G.value,endOnly:!0})],onmove:o=>{if(t.properties.lock)return;const a=d.value.findIndex(f=>f.id===t.id);a!==-1&&(d[a].properties.x+=o.dx,d[a].properties.y+=o.dy,A())}}).resizable({enabled:!t.properties.lock,edges:{left:!0,right:!0,bottom:!0,top:!0},modifiers:[K.modifiers.restrictSize({min:{width:10,height:10}})],onmove:o=>{if(t.properties.lock)return;const a=d.value.findIndex(f=>f.id===t.id);a!==-1&&(d[a].properties.width=o.rect.width,d[a].properties.height=o.rect.height,d[a].properties.x+=o.deltaRect.left,d[a].properties.y+=o.deltaRect.top,A())}}).on("tap",()=>ae(t.id))},ae=t=>{console.log("Selecting element:",t),c.value=t,H.value=S.value.findIndex(e=>e.id===t),A()},se=t=>{console.log("Selecting layer:",t),H.value=t,c.value=S.value[t].id,A()},A=(t=null)=>{if(c.value===null)return;const e=d.value.find(o=>o.id===c.value);e&&(t&&(e.type==="text"?e.properties={...e.properties,...t,width:t.w,height:t.h,rotation:t.r}:e.type==="image"||e.type==="eventlogo"||e.type==="useravatar"?e.properties={...e.properties,...t,width:t.w,height:t.h,rotation:t.r}:e.type==="qrcode"?e.properties={...e.properties,...t,width:t.w,height:t.h,rotation:t.r}:e.properties={...e.properties,...t,width:t.w,height:t.h,rotation:t.r}),e.type==="text"?l.value={x:e.properties.x||40.1,y:e.properties.y||130,w:e.properties.width||317,h:e.properties.height||55,r:e.properties.rotation||0,font:e.properties.font||"Roboto",fontStyle:e.properties.fontStyle||"Regular",fontSize:e.properties.fontSize||16,fillColor:e.properties.fillColor||"#ffffff",fillTransparency:e.properties.fillTransparency||!1,text:e.properties.text||e.properties.exampleText||"",textDecoration:e.properties.textDecoration||"none",color:e.properties.color||"#000000",textAlign:e.properties.textAlign||"left",verticalAlign:e.properties.verticalAlign||"top",textTransform:e.properties.textTransform||"none"}:e.type==="img"?l.value={x:e.properties.x||148.5,y:e.properties.y||284,w:e.properties.width||100,h:e.properties.height||100,r:e.properties.rotation||0,src:e.properties.src||"https://via.placeholder.com/150",strokeColor:e.properties.strokeColor||"#eb2f2f",strokeWidth:e.properties.strokeWidth||1,associatedData:e.properties.associatedData||"User ID"}:e.type==="qrcode"?l.value={x:e.properties.x||20.5,y:e.properties.y||25,w:e.properties.width||100,h:e.properties.height||100,r:e.properties.rotation||0,content:e.properties.content||"https://example.com",size:e.properties.size||100}:l.value={x:e.properties.x||0,y:e.properties.y||0,w:e.properties.width||100,h:e.properties.height||100,r:e.properties.rotation||0})},F=()=>{if(c.value===null)return;const t=d.value.findIndex(o=>o.id===c.value);if(t===-1)return;const e=d.value[t];e.type==="h1"?e.properties={...e.properties,x:l.value.x,y:l.value.y,width:l.value.w,height:l.value.h,rotation:l.value.r,font:l.value.font,fontStyle:l.value.fontStyle,fontSize:l.value.fontSize,fillColor:l.value.fillColor,fillTransparency:l.value.fillTransparency,text:l.value.text,textDecoration:l.value.textDecoration,color:l.value.color,textAlign:l.value.textAlign,verticalAlign:l.value.verticalAlign,textTransform:l.value.textTransform}:e.type==="image"||e.type==="eventlogo"||e.type==="useravatar"?e.properties={...e.properties,x:l.value.x,y:l.value.y,width:l.value.w,height:l.value.h,rotation:l.value.r,src:l.value.src,strokeColor:l.value.strokeColor,strokeWidth:l.value.strokeWidth,associatedData:l.value.associatedData}:e.type==="qrcode"?e.properties={...e.properties,x:l.value.x,y:l.value.y,width:l.value.w,height:l.value.h,rotation:l.value.r,content:l.value.content,size:l.value.size}:e.properties={...e.properties,x:l.value.x,y:l.value.y,width:l.value.w,height:l.value.h,rotation:l.value.r}},ie=t=>{S.value[t].visible=!S.value[t].visible;const e=d.value.findIndex(o=>o.id===S.value[t].id);e!==-1&&(d[e].properties.lock=!S.value[t].visible,A())},ue=t=>{if(c.value===null)return;const e=d.value.find(f=>f.id===c.value);if(!e)return;const o=G.value.getBoundingClientRect(),a=l.value.w||e.properties.width;switch(t){case"left":l.value.x=0;break;case"center":l.value.x=(o.width-a)/2;break;case"right":l.value.x=o.width-a;break}F()},de=t=>{if(c.value===null)return;const e=d.value.find(f=>f.id===c.value);if(!e)return;const o=G.value.getBoundingClientRect(),a=l.value.h||e.properties.height;switch(t){case"top":l.value.y=0;break;case"middle":l.value.y=(o.height-a)/2;break;case"bottom":l.value.y=o.height-a;break}F()},ce=t=>{if(c.value===null)return;const e=d.value.find(o=>o.id===c.value);!e||e.type!=="text"||(t==="bold"?l.value.fontStyle=l.value.fontStyle==="Bold"?"Regular":"Bold":t==="italic"?l.value.fontStyle=l.value.fontStyle==="Italic"?"Regular":"Italic":t==="underline"&&(l.value.textDecoration=l.value.textDecoration==="underline"?"none":"underline"),x())},x=(t=null)=>{if(c.value===null)return;const e=d.value.find(a=>a.id===c.value);if(!e||e.type!=="text")return;t&&(l.value={...l.value,...t});const o=document.querySelector(`[data-element-id="${e.id}"] div[contenteditable]`);if(o&&(o.style.fontFamily=l.value.font,o.style.fontSize=`${l.value.fontSize}px`,o.style.fontWeight=l.value.fontStyle==="Bold"?"bold":"normal",o.style.fontStyle=l.value.fontStyle==="Italic"?"italic":"normal",o.style.color=l.value.color,o.style.backgroundColor=l.value.fillTransparency?"transparent":l.value.fillColor,o.style.textDecoration=l.value.textDecoration,o.style.textAlign=T.value==="right side only"?"right":l.value.textAlign,o.style.verticalAlign=l.value.verticalAlign,o.style.textTransform=l.value.textTransform,o.style.direction=T.value==="right side only"?"rtl":"ltr",o.setAttribute("dir",T.value==="right side only"?"rtl":"ltr"),o.textContent=l.value.text||e.properties.exampleText,T.value==="right side only")){const a=document.createRange(),f=window.getSelection();a.selectNodeContents(o),a.collapse(!1),f.removeAllRanges(),f.addRange(a)}F()},pe=()=>{M.value==="text"&&(l.value.fillColor="rgba(0, 0, 0, 0)",l.value.fillTransparency=!0,x())},ve=t=>{M.value==="text"&&(l.value.fillColor=t,l.value.fillTransparency=!1,x(),Te(()=>{const e=document.querySelector(`[data-element-id="${c.value}"] div[contenteditable]`);e&&(e.style.backgroundColor=l.value.fillColor)}))},fe=t=>{M.value==="text"&&(l.value.textAlign=t,x())},ge=t=>{M.value==="text"&&(l.value.verticalAlign=t,x())},ye=t=>{M.value==="text"&&(l.value.textTransform=t,x())},me=t=>{T.value=t,x()};return j(c,()=>{A(),c.value&&x()}),j(l,()=>F(),{deep:!0}),Se(()=>{d.value.forEach(re)}),j(T,()=>{x()}),(t,e)=>{const o=he,a=xe,f=be,L=Ne;return h(),I("div",We,[n("div",Oe,[n("div",Xe,[n("div",Ye,[n("div",Ge,[n("button",{class:V(["flex-1 px-4 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-400",{"bg-blue-500 text-white":r(p)==="front","bg-gray-200 text-gray-700 hover:bg-gray-300":r(p)!=="front","rounded-l-md":!0}]),onClick:e[0]||(e[0]=m=>v("front")),disabled:r(g)}," Front Side ",10,He),n("button",{class:V(["flex-1 px-4 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-400",{"bg-blue-500 text-white":r(p)==="back","bg-gray-200 text-gray-700 hover:bg-gray-300":r(p)!=="back","rounded-r-md":!0}]),onClick:e[1]||(e[1]=m=>v("back")),disabled:r(g)}," Back Side ",10,Ke)])]),n("div",Qe,[n("button",{class:"p-1 bg-gray-200 rounded hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400",onClick:e[2]||(e[2]=m=>s(-10))},[q(o,{name:"mdi:minus",class:"w-4 h-4"})]),n("span",Je,J(r(_))+"%",1),n("button",{class:"p-1 bg-gray-200 rounded hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400",onClick:e[3]||(e[3]=m=>s(10))},[q(o,{name:"mdi:plus",class:"w-4 h-4"})]),n("button",{class:V(["p-1 bg-gray-200 rounded hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400",{"bg-blue-500 text-white":r(y)}]),onClick:u},[q(o,{name:"mdi:grid",class:"w-4 h-4"})],2)])]),n("div",Ze,[n("div",{ref_key:"dropzone",ref:z,class:V(["design-page w-[400px] sm:w-[500px] h-[500px] sm:h-[600px] bg-white",{"grid-overlay":r(y),flipped:r(p)==="back"}]),style:le({transform:`scale(${r(O)})`,transformOrigin:"center top"}),onDragover:e[8]||(e[8]=oe(()=>{},["prevent"])),onDrop:k},[n("div",Pe,[n("div",et,[r(p)==="front"?(h(),N(a,{key:0,modelValue:r(D),sendElement:r(b),onAddToFrontCanvas:e[4]||(e[4]=m=>r(D).push(m)),onRequestFrontImage:e[5]||(e[5]=m=>R.value=!0),onSendSelectedElement:P},null,8,["modelValue","sendElement"])):$("",!0)]),n("div",tt,[r(p)==="back"?(h(),N(a,{key:0,modelValue:r(w),sendElement:r(b),onAddToBackCanvas:e[6]||(e[6]=m=>r(w).push(m)),onRequestBackImage:e[7]||(e[7]=m=>B.value=!0),onSendSelectedElement:P},null,8,["modelValue","sendElement"])):$("",!0)])])],38)])]),q(f,{"selected-element":r(c),"selected-element-type":r(M),layers:r(S),"selected-layer":r(H),"current-properties":r(l),"display-option":r(T),onDragStart:U,onDragEnd:X,onAlignHorizontal:ue,onAlignVertical:de,onUpdateProperties:A,onApplyTextStyle:x,onMakeTransparent:pe,onApplyColor:ve,onApplyTextAlign:fe,onApplyVerticalAlign:ge,onApplyTextTransform:ye,onToggleTextStyle:ce,onApplyDisplayOption:me,onSelectLayer:se,onToggleLayerVisibility:ie},null,8,["selected-element","selected-element-type","layers","selected-layer","current-properties","display-option"]),r(R)?(h(),N(L,{key:0,side:"front",onUploaded:E,onClose:e[9]||(e[9]=m=>R.value=!1)})):$("",!0),r(B)?(h(),N(L,{key:1,side:"back",onUploaded:Y,onClose:e[10]||(e[10]=m=>B.value=!1)})):$("",!0)])}}},it=ne(lt,[["__scopeId","data-v-d01d165c"]]);export{it as default};
//# sourceMappingURL=CqzOgY9y.js.map
