import{I as G,r as y,k as I,o as U,x as l,y as a,z as c,K as f,X as r,P as z,V as _,Q as R,S as x,R as T,J as ee,A as v,Z as te}from"./DKi7S-AL.js";import{_ as se}from"./DlAUqK2U.js";const oe=["onMousedown"],ne={key:0,class:"absolute -top-5 left-0 px-1 text-xs text-white bg-blue-600"},ie={class:"absolute left-1/2 -top-10 -translate-x-1/2 text-xs text-red-500"},ae={class:"absolute -left-6 top-1/2 -translate-y-1/2 text-xs text-red-500"},le={class:"absolute -right-6 top-1/2 -translate-y-1/2 text-xs text-red-500"},re={class:"absolute left-1/2 -bottom-5 -translate-x-1/2 text-xs text-red-500"},ce=["onMousedown"],de=["onMousedown"],ue=["src"],he={__name:"Canvas",props:{modelValue:Array,sendElement:Object},emits:["addToFrontCanvas","addToBackCanvas","requestFrontImage","requestBackImage","sendSelectedElement"],setup(X,{emit:Y}){const M=X,d=Y;G(()=>M.sendElement,t=>{t&&F(t)});const h=y(null),i=I(()=>M.modelValue),A=["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],E=y(0),k=y(0);let m="",g={x:0,y:0},p=-1;y(null),U(()=>{new ResizeObserver(()=>{E.value=h.value?.offsetWidth,k.value=h.value.offsetHeight}).observe(h.value)});function F(t){if(t.item.type==="img"){t.side==="front"?d("requestFrontImage"):d("requestBackImage");return}const s={id:Date.now(),text:t.item.label||"Sample Text",type:t.item.type,label:`${t.item.label}`,position:t.position,properties:{y:t.y,x:t.x},size:{width:250,height:70},rotation:0,isSelected:!1,isDragging:!1,direction:"ltr"};t.side==="front"?d("addToFrontCanvas",s):d("addToBackCanvas",s)}function O(){i.value.forEach(t=>t.isSelected=!1),p=-1,d("sendSelectedElement",null)}function V(t,s){i.value.forEach((e,n)=>e.isSelected=n===t),p=t,q(t,s),console.log("Canvas clicked, deselecting all elements",i.value[t].id),d("sendSelectedElement",i.value[t].id)}function q(t,s){const e=i.value[t];g.x=s.clientX-e.position.left,g.y=s.clientY-e.position.top,e.isDragging=!0,document.addEventListener("mousemove",b),document.addEventListener("mouseup",w)}function b(t){const s=i.value[p],e=h.value.getBoundingClientRect();let n=t.clientX-g.x,o=t.clientY-g.y;n=Math.max(0,Math.min(e.width-s.size.width,n)),o=Math.max(0,Math.min(e.height-s.size.height,o)),s.position.left=n,s.position.top=o}function H(t,s){p=t,m=s,document.addEventListener("mousemove",S),document.addEventListener("mouseup",w)}function S(t){const s=i.value[p],e=40,n=t.movementX,o=t.movementY;m.includes("right")&&(s.size.width=Math.max(e,s.size.width+n)),m.includes("left")&&(s.size.width=Math.max(e,s.size.width-n),s.position.left+=n),m.includes("bottom")&&(s.size.height=Math.max(e,s.size.height+o)),m.includes("top")&&(s.size.height=Math.max(e,s.size.height-o),s.position.top+=o)}function j(t,s){const e=i.value[t],n=e.position.left+e.size.width/2,o=e.position.top+e.size.height/2,L=s.clientX,P=s.clientY,$=L-n,N=P-o,W=Math.atan2(N,$)*(360/Math.PI),J=e.rotation;function C(D){const K=D.clientX-n,Q=D.clientY-o,Z=(Math.atan2(Q,K)*(360/Math.PI)-W)*12;e.rotation=(J+Z+360)%360}function B(){document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",B)}document.addEventListener("mousemove",C),document.addEventListener("mouseup",B)}function w(){i.value.forEach(t=>t.isDragging=!1),document.removeEventListener("mousemove",b),document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",w)}const u=I(()=>i.value.find(t=>t.isSelected));return(t,s)=>(a(),l("div",null,[c("div",{ref_key:"canvas",ref:h,class:"absolute w-full h-full bg-white select-none",onMousedown:O},[r(u)&&r(u).isDragging?(a(),l(z,{key:0},[c("div",{class:"absolute top-0 bottom-0 w-px bg-blue-500 z-0",style:_({left:r(u).position.left+r(u).size.width/2+"px"})},null,4),c("div",{class:"absolute left-0 right-0 h-px bg-blue-500 z-0",style:_({top:r(u).position.top+r(u).size.height/2+"px"})},null,4)],64)):f("",!0),(a(!0),l(z,null,R(r(i),(e,n)=>(a(),l("div",{key:e.id,class:T(["absolute border group",e.isSelected?"border-blue-500":"border-transparent"]),style:_({top:e.position.top+"px",left:e.position.left+"px",width:e.size.width+"px",height:e.size.height+"px",transform:`rotate(${e.rotation}deg)`,transformOrigin:"center center"}),onMousedown:x(o=>V(n,o),["stop"])},[e.isSelected&&e.label?(a(),l("div",ne,v(e.label),1)):f("",!0),e.isDragging?(a(),l(z,{key:1},[c("div",ie," Y: "+v(Math.round(e.position.top)),1),c("div",ae,v(Math.round(e.position.left+e.size.width/2)),1),c("div",le,v(Math.round(r(E)-e.position.left-e.size.width/2)),1),c("div",re,v(Math.round(r(k)-e.position.top-e.size.height/2)),1)],64)):f("",!0),e.isSelected?(a(),l("div",{key:2,class:"rotate-icon",onMousedown:x(o=>j(n,o),["stop","prevent"])}," ðŸ”„ ",40,ce)):f("",!0),e.isSelected?(a(),l(z,{key:3},R(A,o=>c("div",{key:o,class:T(["handle",o]),onMousedown:x(L=>H(n,o),["stop","prevent"])},null,42,de)),64)):f("",!0),e.type!=="img"?(a(),ee(te(e.type),{key:4,contenteditable:"",class:"flex justify-center items-center outline-none cursor-move leading-tight text-center w-full h-full",style:_({fontSize:Math.max(12,Math.min(48,e.type=="p"?e.size.height*.2:e.size.height*.4))+"px",fontFamily:"popins, sans-serif",color:e.textColor||"black"}),innerHTML:e.text},null,8,["style","innerHTML"])):(a(),l("img",{key:5,src:e.text.src,class:"w-full h-full object-contain cursor-pointer select-none"},null,8,ue))],46,oe))),128))],544)]))}},ve=se(he,[["__scopeId","data-v-eb911b98"]]);export{ve as _};
//# sourceMappingURL=Cn02XgkK.js.map
